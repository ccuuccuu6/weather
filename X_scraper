#!/usr/bin/env python3
import sys
import requests
import datetime

# ─── CONFIG ────────────────────────────────────────────────────────────────
BEARER_TOKEN = "…your token here…"
if not BEARER_TOKEN:
    sys.exit("Error: Please set your BEARER_TOKEN in the script.")

URL = "https://api.twitter.com/2/tweets/counts/recent"

def fetch_recent_counts(query, granularity="day"):
    headers = {"Authorization": f"Bearer {BEARER_TOKEN}"}
    params  = {"query": query, "granularity": granularity}
    resp    = requests.get(URL, headers=headers, params=params)
    resp.raise_for_status()
    return resp.json()

def print_counts(data):
    for bucket in data.get("data", []):
        day   = bucket["start"][:10]
        count = bucket["tweet_count"]
        print(f"{day}: {count}")

def main(query="#boycottdove"):
    print(f"Fetching daily counts for: {query!r}\n")
    data = fetch_recent_counts(query)
    print_counts(data)

if __name__ == "__main__":
    # If you run as a script you still get a CLI override:
    #   python yourscript.py "#otherhashtag"
    q = sys.argv[1] if len(sys.argv) > 1 else None
    main(q or "#boycottdove")
